<!DOCTYPE html>
<html lang="zh-CN"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>问题详情</title>
    <link rel="icon" href="https://jiangxiekeji.com/img/logo-icon.png">
    <link rel="stylesheet" href="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/bootstrap.min.css">
    <link rel="stylesheet" href="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/problem.css">
<script src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/inject.js" id="imt-image-inject"></script><style data-id="immersive-translate-input-injected-css">.immersive-translate-input {
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 2147483647;
  display: flex;
  justify-content: center;
  align-items: center;
}
.immersive-translate-attach-loading::after {
  content: " ";

  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;

  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-2000%, -50%);
  z-index: 100;
}

.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}

.immersive-translate-input-loading {
  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;
}

@keyframes immersiveTranslateShadowRolling {
  0% {
    box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  12% {
    box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  25% {
    box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
      0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  36% {
    box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
      100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
  }

  50% {
    box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
      110px 0 var(--loading-color), 100px 0 var(--loading-color);
  }

  62% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
      120px 0 var(--loading-color), 110px 0 var(--loading-color);
  }

  75% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      130px 0 var(--loading-color), 120px 0 var(--loading-color);
  }

  87% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
  }

  100% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
      200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
  }
}

.immersive-translate-toast {
  display: flex;
  position: fixed;
  z-index: 2147483647;
  left: 0;
  right: 0;
  top: 1%;
  width: fit-content;
  padding: 12px 20px;
  margin: auto;
  overflow: auto;
  background: #fef6f9;
  box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
  font-size: 15px;
  border-radius: 8px;
  color: #333;
}

.immersive-translate-toast-content {
  display: flex;
  flex-direction: row;
  align-items: center;
}

.immersive-translate-toast-hidden {
  margin: 0 20px 0 72px;
  text-decoration: underline;
  cursor: pointer;
}

.immersive-translate-toast-close {
  color: #666666;
  font-size: 20px;
  font-weight: bold;
  padding: 0 10px;
  cursor: pointer;
}

@media screen and (max-width: 768px) {
  .immersive-translate-toast {
    top: 0;
    padding: 12px 0px 0 10px;
  }
  .immersive-translate-toast-content {
    flex-direction: column;
    text-align: center;
  }
  .immersive-translate-toast-hidden {
    margin: 10px auto;
  }
}

.immersive-translate-modal {
  display: none;
  position: fixed;
  z-index: 2147483647;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0, 0, 0);
  background-color: rgba(0, 0, 0, 0.4);
  font-size: 15px;
}

.immersive-translate-modal-content {
  background-color: #fefefe;
  margin: 10% auto;
  padding: 40px 24px 24px;
  border: 1px solid #888;
  border-radius: 10px;
  width: 80%;
  max-width: 270px;
  font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
    "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
    "Segoe UI Symbol", "Noto Color Emoji";
  position: relative;
}

@media screen and (max-width: 768px) {
  .immersive-translate-modal-content {
    margin: 50% auto !important;
  }
}

.immersive-translate-modal .immersive-translate-modal-content-in-input {
  max-width: 500px;
}
.immersive-translate-modal-content-in-input .immersive-translate-modal-body {
  text-align: left;
  max-height: unset;
}

.immersive-translate-modal-title {
  text-align: center;
  font-size: 16px;
  font-weight: 700;
  color: #333333;
}

.immersive-translate-modal-body {
  text-align: center;
  font-size: 14px;
  font-weight: 400;
  color: #333333;
  word-break: break-all;
  margin-top: 24px;
}

@media screen and (max-width: 768px) {
  .immersive-translate-modal-body {
    max-height: 250px;
    overflow-y: auto;
  }
}

.immersive-translate-close {
  color: #666666;
  position: absolute;
  right: 16px;
  top: 16px;
  font-size: 20px;
  font-weight: bold;
}

.immersive-translate-close:hover,
.immersive-translate-close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

.immersive-translate-modal-footer {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  margin-top: 24px;
}

.immersive-translate-btn {
  width: fit-content;
  color: #fff;
  background-color: #ea4c89;
  border: none;
  font-size: 16px;
  margin: 0 8px;
  padding: 9px 30px;
  border-radius: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.immersive-translate-btn:hover {
  background-color: #f082ac;
}
.immersive-translate-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
.immersive-translate-btn:disabled:hover {
  background-color: #ea4c89;
}

.immersive-translate-cancel-btn {
  /* gray color */
  background-color: rgb(89, 107, 120);
}

.immersive-translate-cancel-btn:hover {
  background-color: hsl(205, 20%, 32%);
}

.immersive-translate-action-btn {
  background-color: transparent;
  color: #ea4c89;
  border: 1px solid #ea4c89;
}

.immersive-translate-btn svg {
  margin-right: 5px;
}

.immersive-translate-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #007bff;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.immersive-translate-primary-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #ea4c89;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.immersive-translate-modal input[type="radio"] {
  margin: 0 6px;
  cursor: pointer;
}

.immersive-translate-modal label {
  cursor: pointer;
}

.immersive-translate-close-action {
  position: absolute;
  top: 2px;
  right: 0px;
  cursor: pointer;
}

.imt-image-status {
  background-color: rgba(0, 0, 0, 0.5) !important;
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 16px !important;
}
.imt-image-status img,
.imt-image-status svg,
.imt-img-loading {
  width: 28px !important;
  height: 28px !important;
  margin: 0 0 8px 0 !important;
  min-height: 28px !important;
  min-width: 28px !important;
  position: relative !important;
}
.imt-img-loading {
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
  background-size: 28px 28px;
  animation: image-loading-rotate 1s linear infinite !important;
}

.imt-image-status span {
  color: var(--bg-2, #fff) !important;
  font-size: 14px !important;
  line-height: 14px !important;
  font-weight: 500 !important;
  font-family: "PingFang SC", Arial, sans-serif !important;
}

@keyframes image-loading-rotate {
  from {
    transform: rotate(360deg);
  }
  to {
    transform: rotate(0deg);
  }
}
</style></head>

<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 col-sm-12 col-sm-offset-0">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="https://jiangxiekeji.com/index.html">
                            <img style="height: 40px;" src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/logo.png" alt="img">
                        </a>
                    </div>
                    <div id="navbar" class="navbar-collapse collapse">
                        <ul class="nav navbar-nav">
                            <li><a href="https://jiangxiekeji.com/index.html#head1">教学视频</a></li>
                            <li><a href="https://jiangxiekeji.com/index.html#head2">套件获取</a></li>
                            <li><a href="https://jiangxiekeji.com/index.html#head3">资料下载</a></li>
                            <li><a href="https://jiangxiekeji.com/index.html#head4">疑难解答</a></li>
                            <li><a href="https://jiangxiekeji.com/index.html#head5">关于我们</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <div style="height: 50px;"></div>

    <!-- 正文 -->
    <div class="container main-content">
        <div class="row">
            <div class="col-sm-10 col-xs-12 col-sm-offset-1">
                <a href="https://jiangxiekeji.com/problem.html" class="btn btn-primary" role="button">&lt; 返回 </a>
                <hr>

                <h1>问题1：Keil5工程里的程序文件，英文正常但是汉字乱码</h1>
                <h2>本文最后更新时间：2024.6.8</h2>

                <h3>问题原因</h3>
                <p><em>UTF-8与GB2312编码不兼容。</em></p>
                <p>目前汉字的编码主要有以GB开头的国标码（GB2312/GBK/GB18030）和万国码传输格式（UTF-8）两种，两种编码均存在且互不兼容。</p>
                <p>Keil5软件默认一般是GB2312，UP主视频的工程一般默认UTF-8，网上其他人的代码，编码格式也不确定，当这些工程互相添加文件后，就容易导致中文乱码。</p>

                <h3>解决方法</h3>

                <p><em>统一整个工程所有文件的编码格式，并在Keil5软件的配置中选择正确的编码设置。</em></p>
                <p>请根据以下情况选择对应的解决办法。</p>


                <p>1. 若乱码现象如下图所示，英文正常，但是中文出现了很多绿色方块状的乱码。则此状况的原因是文件的编码格式是GB2312，而软件配置的编码格式却是UTF-8。软件使用UTF-8的编码解析GB2312的编码，自然会出现汉字乱码。 </p>

                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-1.jpg" alt="img">
                    <h4>英文正常，但是中文出现了绿色方块状的乱码</h4>
                </div>

                <p>解决办法是：点击扳手图标，打开Keil5的配置界面，Encoding下拉框选择“Encode in ANSI”或者“Chinese GB2312（Simplified）”，以GB2312的编码格式来解析文件。</p>

                <p>下图为选择“Chinese GB2312（Simplified）”的现象，中文正常，但是选择GB2312后，字体就自动变成非等宽字体了。</p>


                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-2.jpg" alt="img">
                    <h4>工程配置中选择Encoding为GB2312</h4>
                </div>

                <p>下图为选择“Encode in ANSI”的现象，中文正常，但是选择ANSI后，用光标选择汉字或者删除汉字时，会出现半字的Bug。</p>


                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-3.jpg" alt="img">
                    <h4>工程配置中选择Encoding为ANSI</h4>
                </div>

                <p>另外注意，修改软件配置中的Encoding下拉框，只是改变软件解析的格式，并不会改变程序文件原来的编码格式，例如下图中，虽然配置中选择的是GB2312，但实际上程序文件的编码格式仍然是UTF-8。</p>


                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-4.jpg" alt="img">
                    <h4>修改Encoding下拉框并不会改变程序文件原来的编码格式</h4>
                </div>

                <p><em>如果不确定文件的编码，可以在这个下拉框中的“Encode in ANSI”、“Chinese GB2312（Simplified）”和“Encode in UTF-8 without signature”三者之间自行切换，看看哪一个选项合适。</em></p>


                <p>2. 若将UP主提供的程序文件加入到网上别人的工程，或者在UP主提供的工程中加入网上别人的程序文件，则此操作很可能会导致各个文件编码格式不统一的问题。这样无论怎么修改工程的配置，都容易出现中文乱码，尤其是将汉字写入程序内部的情况。</p>

                <p>为了避免文件编码格式不统一或者不清楚文件的编码格式是哪种的问题，我们可以用软件统一将工程的文件修改编码格式。</p>

                <p>UltraCodingSwitch这款软件可以完成编码格式修改的任务，点击如下链接，获取软件：</p>

                <p><a style="word-break: break-all;" target="_blank" href="https://pan.baidu.com/s/156hTUAkJz2T2CyfjZdgk6w?pwd=dhjt">https://pan.baidu.com/s/156hTUAkJz2T2CyfjZdgk6w?pwd=dhjt</a>，提取码：dhjt，链接内压缩包解压密码：ultra。</p>

                <p>软件使用方法如下：</p>

                <p>打开软件，点击“+文件夹”,选中并添加想要转换编码格式的工程文件夹。</p>

                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-5.jpg" alt="img">
                    <h4>添加工程文件夹</h4>
                </div>

                <p>添加工程文件夹后，点击“编码方式”按钮，并选择想要转换的目标编码格式。</p>
                <p>例如此示例中，我想要工程编码格式全部转换为UTF-8，则勾选“UTF8”选项的勾。如果想转换为GB2312，则勾选“GBK/GB2312”的勾即可。</p>

                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-6.jpg" alt="img">
                    <h4>选择目标编码格式</h4>
                </div>

                <p>最后点击“开始”按钮，开始转换。转换完成后，下面会提示结果。</p>

                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-7.jpg" alt="img">
                    <h4>转换完成</h4>
                </div>

                <p>若在转换时，出现了“Cannot create file ...”的报错，这个一般是因为工程中有只读文件，需要在工程文件夹右键，属性，取消只读的选项。取消只读后，再进行上述转换即可。</p>

                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-8.jpg" alt="img">
                    <h4>取消文件的只读属性</h4>
                </div>

                <p>文件夹所有文件的编码格式转换之后，再在Keil软件的配置里选择对应的Encoding，即可实现每个文件的编码和解析一致。</p>

                <p>另外，此软件还可以使用“+文件”的功能，只转换部分关键文件，这样可以不对工程所有的文件进行编码格式变更。转换时，也可配置过滤器等功能。大家可以自行研究。</p>

                <div class="img-box">
                    <img src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/px-1-9.jpg" alt="img">
                    <h4>编码转换软件的更多功能</h4>
                </div>

                <hr>
                <a href="https://jiangxiekeji.com/problem.html" class="btn btn-primary" role="button">&lt; 返回 </a>
            </div>

        </div>
    </div>
    <div style="height: 200px;"></div>
    <script src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/jquery.min.js"></script>
    <script src="%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85_files/bootstrap.min.js"></script>


</body><div id="immersive-translate-popup" style="all: initial"></div></html>